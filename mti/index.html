<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <link rel="canonical" href="https://projectisp.github.io/ISP_tutorial.github.io/mti/">
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Seismic Moment Tensor Inversion - ISP Tutorial</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/fontawesome.min.css" rel="stylesheet">
        <link href="../css/brands.min.css" rel="stylesheet">
        <link href="../css/solid.min.css" rel="stylesheet">
        <link href="../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/color-brewer.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">ISP Tutorial</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="nav-item">
                                <a href="../install/" class="nav-link">Installation</a>
                            </li>
                            <li class="nav-item">
                                <a href="../basics/" class="nav-link">Start with the basics</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Modules</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../el/" class="dropdown-item">Earthquake Location</a>
</li>
                                    
<li>
    <a href="../tf/" class="dropdown-item">Time-Frequency Analysis</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active" aria-current="page">Seismic Moment Tensor Inversion</a>
</li>
                                    
<li>
    <a href="../aa/" class="dropdown-item">Array Analysis</a>
</li>
                                    
<li>
    <a href="../rf/" class="dropdown-item">Receiver Functions</a>
</li>
                                    
<li>
    <a href="../ant/" class="dropdown-item">Ambient Noise Tomography</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Additional Toolboxes</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../db/" class="dropdown-item">Database</a>
</li>
                                    
<li>
    <a href="../rd/" class="dropdown-item">Retrieve Data</a>
</li>
                                    
<li>
    <a href="../ppsds/" class="dropdown-item">PPSDs</a>
</li>
                                    
<li>
    <a href="../synth/" class="dropdown-item">Synthetic Generator</a>
</li>
                                    
<li>
    <a href="../nrt/" class="dropdown-item">Near Real Time Adquisition</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Signal Processing</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../sp_filtering/" class="dropdown-item">Basic Processing Tools</a>
</li>
                                    
<li>
    <a href="../remove_response/" class="dropdown-item">Remove Instrument Response</a>
</li>
                                    
<li>
    <a href="../sp_integrate/" class="dropdown-item">Integrate & Differenciate</a>
</li>
                                    
<li>
    <a href="../smoothing/" class="dropdown-item">Smoothing</a>
</li>
                                    
<li>
    <a href="../sp_denoising/" class="dropdown-item">Denoising</a>
</li>
                                    
<li>
    <a href="../noise_processing/" class="dropdown-item">Noise Processing</a>
</li>
                                    
<li>
    <a href="../resample/" class="dropdown-item">Resampling</a>
</li>
                                </ul>
                            </li>
                            <li class="nav-item">
                                <a href="../progress/" class="nav-link">Gallery & Progress</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle" role="button" data-bs-toggle="dropdown"  aria-expanded="false">About</a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../refs/" class="dropdown-item">References</a>
</li>
                                    
<li>
    <a href="../license.md" class="dropdown-item">License</a>
</li>
                                    
<li>
    <a href="../release_notes/" class="dropdown-item">Release Notes</a>
</li>
                                    
<li>
    <a href="../FAQs.md" class="dropdown-item">FAQs</a>
</li>
                                    
<li>
    <a href="../Special_Thanks/" class="dropdown-item">The Developer Team of ISP thanks to:</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../tf/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../aa/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#moment-tensor-inversion-mti" class="nav-link">Moment Tensor Inversion (MTI).</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-bs-level="2"><a href="#methodology" class="nav-link">Methodology</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#connect-earthquake-analysis-to-mti-module" class="nav-link">Connect Earthquake Analysis to MTI module.</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#create-earth-velocity-model" class="nav-link">Create Earth velocity model</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#bayesian-inversion" class="nav-link">Bayesian Inversion</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#plotting-your-results" class="nav-link">Plotting Your results</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-bs-level="2"><a href="#multimedia-material-mti" class="nav-link">Multimedia Material (MTI)</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="moment-tensor-inversion-mti">Moment Tensor Inversion (MTI).</h1>
<h2 id="methodology">Methodology</h2>
<p>The functionality of this module is based on the Bayes-ISOLA code <a href="https://academic.oup.com/gji/article/210/2/693/3747443">Vackář et al., 2017</a>, a tool for automated CMT inversion in a Bayesian framework. A nice improvement that boost the robusness of the MTI is to use an optional data covariance matrix from pre-event noise that yields an automatic weighting function for the receiver components according to their noise levels. This also serves as an automated frequency filter that suppresses noisy frequency ranges. </p>
<p>During the inversion, a grid search is performed over time and space, combined with an analytical (least squares) moment tensor inversion at each grid point, which accelerates the inversion process. The more time-consuming tasks like the Green’s function computation and the grid search are parallelized for efficiency. The results provided by the module contain the best-fit solution, as well as the full posterior probability density function (PPDF), which allows the user to plot the marginal probability density functions (PDFs) for any of the CMT parameters.</p>
<hr />
<h2 id="connect-earthquake-analysis-to-mti-module">Connect Earthquake Analysis to MTI module.</h2>
<p>The first step to estimate the Focal Mechanism using the MTI module is to send your waveforms in velocity usints to the MTI module. To be familiarize with this process, you have an example inside </p>
<pre>
    <code>
Waveforms, macro and event info --> /isp/example/Moment_Tensor_example
Metadata --> /isp/Metadata/xml/metadata.xml
    </code>
</pre>

<ul>
<li><span style="color:#8E44AD">Create a new project</span> pointing to the files of the example</li>
<li><span style="color:#8E44AD">Load the metadata</span></li>
<li><span style="color:#8E44AD">Load Macro</span></li>
<li><span style="color:#8E44AD">Process and plot</span> your waveforms</li>
<li><span style="color:#8E44AD">Cut the waveforms</span> (remember with Q starttime and E endtime over the plot and check the box Trim Time), then Process and plot your waveforms another time.</li>
</ul>
<p>See the figures related with this example</p>
<p>Click on Macro and Load the file <strong>macro_mti.pkl</strong> from the example:
<img alt="Screenshot" src="../img/macro_mti.png" /></p>
<p>Click on Process and Plot:
<img alt="Screenshot" src="../img/connect_mti.png" /></p>
<p>Now everything is ready!!!, We need to send all of this information (Waveforms plus metadata to MTI module).
Now, <span style="color:red">click on the picture (up left button)</span> <img alt="Screenshot" src="../img/mti_simbol.png" /></p>
<p>This action will connect your waveforms with the MTI module. It will open a dialog asking how to set your earthquake hypocenter source parameters (lat, lon, depth and mag).</p>
<p><img alt="Screenshot" src="../img/mti_dialog.png" /></p>
<p>You can either choose:</p>
<ul>
<li><span style="color:#8E44AD">Manually</span>. After open MTI module, you will have to fill Moment Tensor Parameters box by yourself.</li>
<li><span style="color:#8E44AD">Load Last Location</span>, This action will load the information from your last (last.hyp file) eartuquake location from the default output location folder and will automatically fill the Moment Tensor.</li>
<li><span style="color:#8E44AD">load other</span>, This action will let you choose a "file.hyp" file and will automatically fill the Moment Tensor.</li>
</ul>
<p>Ok, now we are almost ready, next is configurate your eath velocity model</p>
<h2 id="create-earth-velocity-model">Create Earth velocity model</h2>
<p>To start you need to load a Earth model. Go to Build a 1D Earth Model and open the Earth Model Form, the fill it and save it.</p>
<p>Alternatively, Yo can find examples of regional models in <strong>./isp/mti/input/iberia.dat</strong> and <strong>./isp/mti/input/AK135.txt</strong>.</p>
<p><img alt="Screenshot" src="../img/model_MTI.png" /></p>
<hr />
<h2 id="bayesian-inversion">Bayesian Inversion</h2>
<p>In this point the conexion between Earthquake Analysis and MTI module is done. You have in memory the Seismograms processed and the Metadata (information of stations coordinates and the response of the instrument). The connexion is not required, if you want to run the MTI from the database (see database for further details and below to see how to run it).</p>
<p><img alt="Screenshot" src="../img/Moment_Tensor_New.png" /></p>
<ul>
<li>
<p><span style="color:#8E44AD">Output Files</span> &gt;&gt; path to the seismogram files</p>
</li>
<li>
<p><span style="color:#8E44AD">Earth Model</span> &gt;&gt; Path to the Earth model file (see previous section for see how to make this file with ISP, the user can also do it manually).</p>
</li>
<li>
<p><span style="color:#8E44AD">Open Stations/Channels info</span>. This action will allow you select which station/component will be used in the inversion (this is a mandatory action.</p>
</li>
</ul>
<p>Now fill the <span style="color:blue">Moment Tensor Information Box</span>;</p>
<ol>
<li>
<p><strong>Hipocenter Location and Uncertainty (m)</strong><br />
   Include the estimated hypocenter location along with its associated uncertainty in meters.</p>
</li>
<li>
<p><strong>Origin Time and Uncertainty</strong><br />
   Specify the calculated origin time of the event and its corresponding uncertainty.</p>
</li>
<li>
<p><strong>Magnitude</strong><br />
   Provide the event's magnitude as determined from the analysis.</p>
</li>
<li>
<p><strong>Frequency Range for Inversion</strong><br />
   Indicate the frequency range used during the inversion process. Refer to the example shown in the figure below for clarity.</p>
</li>
<li>
<p><strong>Distance Filter</strong><br />
   Exclude stations that fall outside the defined distance filter. This filter is based on the distance from the epicenter to each station.</p>
</li>
<li>
<p><strong>Options for Running the Inversion</strong><br />
   Depending on your analysis, you can choose from the following options:</p>
<pre><code>- Deviatoric  
 Configure the inversion to focus on deviatoric components.

- Source Circular Shape  
 Enforce a circular source shape for the inversion process.

- Covariance 
 Use covariance for the inversion.  
 *Note:* Covariance utilizes a previously calculated noise window. 
 Ensure that this window is sufficiently long (e.g., at least 15 minutes).

- Precalculated Green Functions  
 Utilize precalculated Green functions to streamline the inversion process.  
 *Tip:* Run an initial inversion with this option disabled to generate the necessary Green functions.  
 Once generated, you can refine the inversion by selecting different components, distance filters, or frequency bandwidths.
</code></pre>
</li>
</ol>
<p><img alt="Screenshot" src="../img/Moment_Tensor_Plot.png" /></p>
<h2 id="plotting-your-results">Plotting Your results</h2>
<p>In order to plot your results,</p>
<ul>
<li>
<p><span style="color:#8E44AD">Click at Plot at last solution</span> -- It will print a log file with the result of the inversion, and the beachball of the focal methanism plus the fit of the synthetci seismograms in time and frecuwency domain. Double click on the images to zoom in.</p>
</li>
<li>
<p><span style="color:#8E44AD">Click at Open full report</span>. It will be open the report with the full output images on your webbrowser navigator.</p>
</li>
</ul>
<h2 id="multimedia-material-mti">Multimedia Material (MTI)</h2>
<!-- blank line -->
<figure class="video_container">
  <video controls="true" allowfullscreen="true" poster="../img/poster_image.png" width="740" height="400">
    <source src="../img/MTI.mp4" type="video/mp4">
  </video>
</figure>
<!-- blank line --></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>&copy; 2025 <a href="https://robertocabieces.com"  target="_blank" rel="noopener">Roberto Cabieces</a>
</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>
        <script src="../javascripts/mathjax.js"></script>
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script src="../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
